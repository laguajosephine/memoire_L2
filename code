# Première étape : data cleaning 

library(tidyverse)
library(stargazer)
library(kableExtra)
 
#je propose qu'on renomme le titre des data + Manon: je pense faut qu'on garde age dans la base de données comme ça on peut dans l'analyse des NA voir si c'est genre les gens les + jeunes parce que y'a moyen qu'on ait l'impression de capter des trucs qui sont en fait explicable aussi pâr l'âge. 
load(paste0(path, "37137-0001-Data.rda"))
data_politics <- as.tibble(da36602.0001)
data_politics %>% data_politics
  select(COUNTRY, GROUP, AGE, WHICH_GROUP, COUNTRY_BORN, CITIZENSHIP, LANGUAGE_HOME, POLINT_1, POLINT_2, POLATTENT_1, POLATTENT_2, POLATTENT_3, DISCUSS_ACT, DEMONST_ACT, LEAFLETS_ACT, DONATE_ACT, GRAFFITI_ACT, VOTE_ACT)

#création de la variable Immigration    attends ça marche pas mdr      la variable crée c'est que des NA dedans                         )
cleand <-data_politics %>%
  mutate(
    Immigration = case_when(COUNTRY_BORN %in% c(1,4) ~ "Non immigré",
                            COUNTRY_BORN == 3 ~ "Immigré deuxième génération",
                            COUNTRY_BORN == 6 ~ "Immigré première génération",  
                            COUNTRY_BORN %in% c(2,5) ~ "Métisse"
)
  )
 PROBLÈME ÇA MARCHE PAS DANS IMMIGRATION Y'A QUE DES NA                                           
#supprimer la variable COUNTRYBORN

#présentation rapide de notre échantillon 
dim(cleand)
names(cleand)

#je rajoute une colonne à la base de données qui donne le nombre de NA par ligne 
cleand<-cleand%>%
  mutate(nb_na = rowSums(is.na(.)))
# je crée un vecteur avec que la colonne qui compte les NA et après avec le tableau on voit le nombre d'occurence des différentes valeures 
vectNA<- cleand %>%
  pull(nb_na)
table(vectNA)

# afficher les premiers rangs de notre nouvelle base de données: 
kable(head(cleand,n=10), caption= "premiers rangs des données")


# analyser biais créé par suppression des NA

#pour virer toutes les lignes où y'a des NA
cleand <- cleand %>%
  drop_na()

